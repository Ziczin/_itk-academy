Тестовое задание _itk Академия
Исполнитель:
- Корнеев Александр Сергеевич

Стек:
- бек: fastAPI
  - ОРМ: SQLAlchemy
  - Миграции: alembic
  - Валидация pydantic
- frontend: html+js+css
- БД: PostgreSQL
  - Движок: asyncpg
- Тесты: pytest
  - HTTP-клиент: httpx
  - Асинхронные тесты: pytest-asyncio

Запуск:
- Команда для поднятия приложения: "docker compose up"

Куда смотреть:
- Приложение работает на порту 5051
- http://localhost:5051/

Запуск тестов:
- Команда для запуска тестов кроме нагрузочных "pytest --ignore-highload"
- Команда для запуска всех тестов "pytest -s"
  - Флаг "-s" нужен чтобы видеть сколько прошло запросов
  - ВАЖНО: Тесты запускаются из папки backend и в том окружении где установлены либы из requirements.txt

Сделано:
- По "/" открывается простой фронт
  - Не стал писать данные для инициализации, просто сделал ручку для создания кошелька

- Ручки:
  - get  /api/v1/wallets/ - список кошельков
  - post /api/v1/wallets/ - создание кошелька
  - get  /api/v1/wallets/{wallet_uuid} - баланс конкретного кошелька
  - post /api/v1/wallets/{wallet_uuid}/operation - изменение баланса кошелька
    - если в operation_type передать DEPOSIT - происходит начисление
    - если в operation_type передать WITHDRAW - происходит списание
      - но если сумма списания больше чем есть на балансе, то бросается ошибка, списание не происходит

  - Ручку удаления кошелька не делал
    - (В моём понимании кошельки хранятся всегда, для хранения связанных с ними историй операций)

- Тесты:
  - Тесты требуют включённый докер, чтобы проверять на таком же контейнере, какой есть и в композе
    - Изначально я тестировал на aiosqlite но там механизмы блокировки не очень хорошо работают
  - Позитивные и негативные тесты api на каждую ручку
  - Нагрузочные тесты (если я правильно понял суть таких тестов)
    - 10 подходов по 10  одновременных асинхронных операций списания|пополнения|списания и пополнения вперемешку
    - 10 подходов по 100 одновременных асинхронных операций списания|пополнения|списания и пополнения вперемешку
      - Нагрузочные тесты идут долго, их можно отключить через "pytest -s --ignore-highload"

- Кодовая база
  - Весь код прогнал через isort и black. Анализ flake8 почти чистый